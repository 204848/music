<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gmemp</title>
  <link rel="icon" href="https://meekdai.com/favicon.svg">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shikwasa@2.2.0/dist/style.css">
</head>

<style>
body {background-color:#ededed;}
.page{display: flex;flex-direction: column;height:100vh;}
.imageShow{width:100%;height:100%;background:url(http://img.w3cschool.cn/attachments/knowledge/201610/14632.png) no-repeat;}
.musicPlayer{margin: auto 20px;}
</style>

<body>
<div class="page">
<div class="imageShow"></div>
<div class="musicPlayer"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/shikwasa@2.2.0/dist/shikwasa.min.js"></script>
<script>
let playNum=0;
let imageShow = document.querySelector('.imageShow');

const player = new Shikwasa.Player({
  container: document.querySelector('.musicPlayer'),
  themeColor: '#fd7d7d',
  download: true,

  audio: {
    title: 'title',
    artist: 'artist',
    cover: 'https://meekdai.com/avatar.svg',
    src: 'https://cdn.jsdelivr.net/gh/Meekdai/Gmemp@main/media/Fade.mp3',
  }
})

let media="https://cdn.jsdelivr.net/gh/Meekdai/Gmemp@main/media/"
let requestJson="https://cdn.jsdelivr.net/gh/Meekdai/Gmemp@main/memp.json"
let request=new XMLHttpRequest();
request.open("GET",requestJson);
request.responseType='text';
request.send();
request.onload=function(){
    jsonData=JSON.parse(request.response);
    console.log(jsonData);
    loadMusic(playNum);
}

function loadMusic(playNum) {
  player.update({
    title:jsonData[playNum].title,
    artist:jsonData[playNum].artist,
    cover: 'https://meekdai.com/avatar.svg',
    src:encodeURI(media+jsonData[playNum].mp3)
  });
  // imageShow.src=encodeURI(media+jsonData[playNum].pic);
  imageShow.style.backgroundImage = "url(" +media+ encodeURI(jsonData[playNum].pic) + ")";
}

</script>
</body>
</html>